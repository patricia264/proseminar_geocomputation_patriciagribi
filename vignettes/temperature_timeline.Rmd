---
title: "Temperature Timeline"
author: "Patricia Gribi"
date: "2023-12-11"
output: html_document
---

## Construction of the Temperature-timeline


The overlap period of the 3 data sets was also considered first, in order to 
create the temperature timeline. This because the composition of the time series 
will take place there.


```{r, warning = FALSE}

# plot of another excerpt of the datasets 

ggplot() +
  geom_line(data= temp_pages2k, aes(x = year, y = temp, color = "Temp_pages2K"), size = 1) +
  geom_line(data = temp_NOAA_recentEra, aes(x = year, y = temp, color = "Temp_NOAA_recentEra"), size = 1) +
  geom_line(data = temp_800KYr, aes(x = year, y = temp, color = "Temp_800_KYr"), size = 1) +
  labs(title = "Temperature Over Time",
       x = "Year",
       y = "Temperature in °C") +
  scale_color_manual(values = c("Temp_pages2K" = "yellowgreen", "Temp_NOAA_recentEra" = "coral", "Temp_800_KYr" = "cornflowerblue"), name = "Datasources") +
  xlim(-1, 1912) +
  ylim(11,18) +
  theme_minimal()

```


**Description:**

Starke Fluktuationen der blauen Kurve, viel grösserer
Range der Temperaturwerte. Grüner und orangener Datensatz sind viel
näher beieinander.


**Analysis:**




**Discussion:**

Diskussion: vermutungen / gründe

Die Temperaturdatensätze weisen jeweils andere Referenzperioden auf.
blau Referenzperiode über letzte 1000 Jahre (absolute temp von 13.8°C
dazuaddiert), grün hat Referenzperiode von 1900-2000 (13.9°C
dazuaddiert), orange hat Referenzperiode von 1961-1990 (14°C
dazuaddiert). Der Unterschied der Addition der Referenztemperatur ist
allerdings nicht gross. Gründe für die starken Abweichungen haben also
möglicherweise einen anderen Ursprung.

Temp_pages2K datensatz verwendet mehrere proxies über die (692 records
from 648 locations, including all continental regions and major ocean
basins. The records are from trees, ice, sediment, corals, speleothems,
documentary evidence, and other archives.
<https://www.nature.com/articles/sdata201788> ) Das heisst diese Werte
sind "gemittelt" und fluktuieren weniger stark. Vom noaa-recentEra
Datensatz kann ausgegangen werden, dass die Werte am genauesten sind, da
es sich auch hier wieder um direkte Temperaturmessungen der Atmosphäre
handelt.

Weiteres Vorgehen: weiterer Ausschnit der Daten

```{r, warning = FALSE}

# plot of the overlapping section of the 3 temperature datasets

ggplot() +
  geom_line(data= temp_pages2k, aes(x = year, y = temp, color = "Temp_pages2K"), size = 1) +
  geom_line(data = temp_NOAA_recentEra, aes(x = year, y = temp, color = "Temp_NOAA_recentEra"), size = 1) +
  geom_line(data = temp_800KYr, aes(x = year, y = temp, color = "Temp_800KYr"), size = 1) +
  labs(title = "Temperature Over Time",
       x = "Year",
       y = "Temperature in °C") +
  scale_color_manual(values = c("Temp_pages2K" = "yellowgreen", "Temp_NOAA_recentEra" = "coral", "Temp_800KYr" = "cornflowerblue"), name = "Datasources") +
  xlim(1849, 2001) +
  ylim(12,18) +
  theme_minimal()

```

Beschreibung:

In diesem plot sind die Fluktuationen des blauen Datensatzes noch
deutlicher zu erkennen. Diese liegen in diesem Ausschnitt grösstenteils
erheblich darüber als die Messwerte der 2 anderen Datensätze. Der orange
und der grüne Datensatz stimmen ziemlich gut überein, vor allem über die
letzten 100 Jahre (1900-2000).

Diskussion: vermutungen / gründe

blauer Datensatz nur 8 Werte von 1911-1850. Auch hier stammen die Daten
aus Eisbohrkernen und enthalten daher eine höhere Messungenauigkeit.

Weiteres Vorgehen:

Eisbohrkerne vorher, ab überlappung pages_2K Datensatz. dann ab
temp_NOAA_recentEra offset zwischen den beiden Datensätzen und dann
nurnoch temp_recentEra

```{r, warning = FALSE}

# define overlapping period pages2K and NOAA_recentEra

overlap_period <- c(1850,2000) # start and end of overlapping period


pages2K_overlap_period <- filter(temp_pages2k, year >= overlap_period[1] & year <= overlap_period[2]) 
noaa_overlap_period <- filter(temp_NOAA_recentEra, year >= overlap_period[1] & year <= overlap_period[2])

# calculate the means of the two datasets over this period

pages2K_temp_mean <- mean(pages2K_overlap_period$temp) # mean over overlapping period pages2K
noaa_temp_mean <- mean(noaa_overlap_period$temp) # mean over overlapping period noaa

# mean difference

offset <- noaa_temp_mean - pages2K_temp_mean

# add offset to ice-core dataset

off_temp_pages2k <- data.frame(year = temp_pages2k[1850:2000,1], temp = temp_pages2k[1850:2000,2])

for ( i in 1:151){
  
  off_temp_pages2k[i,2] <- as.numeric(off_temp_pages2k[i,2]) + offset
  
} 

# plot of the old timeline

ggplot() +
  geom_line(data= temp_pages2k, aes(x = year, y = temp, color = "Pages2k"), size = 1) +
  geom_line(data = temp_NOAA_recentEra, aes(x = year, y = temp, color = "NOAA"), size = 1) +
  labs(title = "Temperature Values Over Time",
       x = "Year",
       y = "Temperature in °C") +
  scale_color_manual(values = c("Pages2k" = "black", "NOAA" = "red"),
                     name = "Datasources") +
  xlim(1849, 2001) +
   #ylim(300,450) +
  theme_minimal()


# plot of the corrected timeline consisting of the two datasets

ggplot() +
  geom_line(data= off_temp_pages2k, aes(x = year, y = temp, color = "Pages2k"), size = 1) +
  geom_line(data = temp_NOAA_recentEra, aes(x = year, y = temp, color = "NOAA"), size = 1) +
  labs(title = "Temperature Values Over Time",
       x = "Year",
       y = "Temperature in °C") +
  scale_color_manual(values = c("Pages2k" = "black", "NOAA" = "red"),
                     name = "Datasources") +
  xlim(1849, 2001) +
   #ylim(300,450) +
  theme_minimal()

```

```{r}

# construction of the temp-timeline

# select temp_NOAA_recentEra dataset

temp_timeline <- temp_NOAA_recentEra[temp_NOAA_recentEra$year >= 2000,]

temp_timeline <- temp_timeline %>% arrange(desc(temp_timeline$year))

# add offset data and pages2k dataset

off_temp_pages2k <- off_temp_pages2k %>% arrange(desc(off_temp_pages2k$year))

temp_timeline <- bind_rows(temp_timeline, off_temp_pages2k)

temp_pages2k_rows <- temp_pages2k[temp_pages2k$year < 1850,]

temp_pages2k_rows <- temp_pages2k_rows %>% arrange(desc(temp_pages2k_rows$year))

temp_timeline <- bind_rows(temp_timeline, temp_pages2k_rows)

# add 800KYr dataset

temp_800KYr_rows <- temp_800KYr[temp_800KYr$year < 1,]

temp_timeline <- bind_rows(temp_timeline, temp_800KYr_rows)

# plot

ggplot(data = temp_timeline) +
  geom_line(aes(x = year, y = temp), size = 1) +
  labs(title = "Temperature Values Over Time",
       x = "Year",
       y = "Temperature in °C") +
  #xlim(2000,2022) +
  scale_x_continuous(labels = label_comma()) + 
  theme_minimal()

```

```{r}

# plot of both timelines

combined_timeline <- merge(temp_timeline, co2_timeline, by = "year", all = TRUE)

ggplot() +
  geom_line(data= co2_timeline, aes(x = year, y = temp, color = "CO2"), size = 1) +
  geom_line(data = temp_timeline, aes(x = year, y = temp, color = "Temperature"), size = 1) +
  labs(title = "Temperature- and CO2-Timeline",
       x = "Year",
       y = "Temperature in °C ") +
  scale_color_manual(values = c("CO2" = "coral", "Temperature" = "lightblue"),
                     name = "Variables") +
  xlim(1849, 2001) +
   #ylim(300,450) +
  theme_minimal()


ggplot(combined_timeline, aes(x = year)) +
  geom_line(aes(y = temp, color = "Temperature"), size = 1) +
  geom_line(aes(y = co2, color = "CO2"), size = 1) +  # Scale CO2 for better visualization
  scale_y_continuous(
    name = "Temperature (°C)",
    limits = c(13, 18),
    sec.axis = sec_axis(~.+250, name = "CO2 (ppm)")) +
  scale_color_manual(values = c("Temperature" = "lightblue", "CO2" = "coral")) +
  labs(title = "Temperature- and CO2-Timeline") +
  scale_x_continuous(labels = label_comma()) + 
  theme_minimal()

ggplot() +
  geom_line(data = temp_timeline, aes(x= year, y = temp, color = "Temperature"), size = 1) +
  geom_line(data = co2_timeline, aes(x = year, y = co2, color = "CO2"), size = 1) + 
  scale_y_continuous(
    name = "Temperature (°C)",
    limits = c(13, 18),
    sec.axis = sec_axis(~.+250, name = "CO2 (ppm)")) +
  scale_color_manual(values = c("Temperature" = "lightblue", "CO2" = "coral")) +
  labs(title = "Temperature- and CO2-Timeline") +
  scale_x_continuous(labels = label_comma()) + 
  theme_minimal()


```


# Discussion

Interpretation:
Discuss what the results mean in relation to the research question stated in the introduction.
Comparison to Earlier Findings:
Compare your results to existing literature or earlier findings.
Caveats and Limitations:
Address any limitations in your approach or data.
Discuss potential sources of bias or error.
Relevance:
Explain the relevance of your results in the broader context of the research question.



# Conclusion

Summary:
Summarize the key points from the introduction, methods, results, and discussion.


